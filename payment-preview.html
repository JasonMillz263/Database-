

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Payment Preview - Food Business Academy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  font-family:'Poppins',sans-serif;
  background:#f4f6fb;
  padding:20px;
}
.container{
  max-width:480px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:16px;
  box-shadow:0 8px 25px rgba(0,0,0,0.08);
}
h2{text-align:center;margin-bottom:15px;}
p{margin:6px 0;font-size:14px;}

select,button{
  width:100%;
  padding:12px;
  margin-top:12px;
  border-radius:10px;
  border:1px solid #ddd;
}
button{
  background:#2563eb;
  color:#fff;
  font-weight:600;
  border:none;
  cursor:pointer;
}
button:hover{background:#6d28d9}

/* Invoice Popup */
#invoicePopup{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  z-index:9999;
}
#invoiceBox{
  background:#fff;
  max-width:420px;
  margin:15% auto;
  padding:20px;
  border-radius:16px;
}
.closeBtn{
  background:#22c55e;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="container">
  <h2>Payment Preview</h2>

  <p><strong>Name:</strong> <span id="name"></span></p>
  <p><strong>Email:</strong> <span id="email"></span></p>
  <p><strong>Phone:</strong> <span id="phone"></span></p>
  <p><strong>Course:</strong> <span id="course"></span></p>
  <p><strong>Amount:</strong> $<span id="price"></span></p>

  <select id="method">
    <option value="Ecocash">Ecocash</option>
    <option value="Bank Transfer">Bank Transfer</option>
    <option value="PayPal">PayPal</option>
  </select>

  <!-- IMPORTANT -->
  <button type="button" onclick="proceedPayment()">Proceed to Payment</button>
</div>

<!-- INVOICE POPUP -->
<div id="invoicePopup">
  <div id="invoiceBox">
    <h3>Payment Invoice</h3>

    <p id="invoiceDetails"></p>

    <p><strong>Payment Instructions</strong></p>
    <p>
      üè¶ Bank: CBZ / FBC<br>
      üí∞ Ecocash: 077 XXX XXXX<br>
      üí≥ PayPal: payments@email.com<br>
      üìå Reference: Your Email
    </p>

    <button class="closeBtn" onclick="closeInvoice()">Close</button>
  </div>
</div>

<script>
/* Load student + course data */
const name = localStorage.getItem("studentName");
const email = localStorage.getItem("studentEmail");
const phone = localStorage.getItem("studentPhone");

const params = new URLSearchParams(window.location.search);
const course = params.get("courseName") || "Selected Course";
const price = params.get("coursePrice") || "0";

document.getElementById("name").textContent = name;
document.getElementById("email").textContent = email;
document.getElementById("phone").textContent = phone;
document.getElementById("course").textContent = course;
document.getElementById("price").textContent = price;

async function proceedPayment(){
  let ip = "Unknown";
  try{
    const res = await fetch("https://api.ipify.org?format=json");
    const data = await res.json();
    ip = data.ip;
  }catch(e){}

  const method = document.getElementById("method").value;

  const payments = JSON.parse(localStorage.getItem("payments")) || [];

  payments.push({
    id: Date.now(),
    name,
    email,
    phone,
    course,
    price,
    method,
    ip,
    status: "pending",
    date: new Date().toLocaleString()
  });

  localStorage.setItem("payments", JSON.stringify(payments));

  document.getElementById("invoiceDetails").innerHTML = `
    <strong>Name:</strong> ${name}<br>
    <strong>Email:</strong> ${email}<br>
    <strong>Course:</strong> ${course}<br>
    <strong>Amount:</strong> $${price}<br>
    <strong>Method:</strong> ${method}
  `;

  document.getElementById("invoicePopup").style.display = "block";
}

function closeInvoice(){
  document.getElementById("invoicePopup").style.display = "none";
}
</script>

</body>
</html>
