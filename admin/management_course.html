<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel — Initialize Courses</title>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body{font-family:'Segoe UI',sans-serif;background:#f4f6f9;margin:0;padding:0;color:#333;}
header{background:linear-gradient(135deg,#4A90E2,#007AFF);color:white;padding:20px;text-align:center;font-size:1.5rem;font-weight:bold;letter-spacing:1px;}
.container{max-width:900px;margin:30px auto;background:white;padding:25px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.1);}
h2,h3{color:#007AFF;margin-bottom:10px;display:flex;align-items:center;gap:8px;}
button{background:#007AFF;color:white;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:bold;transition:background 0.3s, transform 0.2s;display:flex;align-items:center;gap:8px;}
button:hover{background:#005BBB;transform:translateY(-2px);}
</style>
</head>
<body>
<header>
<i class="fas fa-cogs"></i> Admin Panel — Initialize Courses
</header>

<div class="container">
  <h2><i class="fas fa-database"></i> Initialize Firestore Structure</h2>
  <p>This will automatically create the 5 predefined courses and empty subcollections for modules, lessons, and quizzes.</p>
  <button onclick="initCourses()"><i class="fas fa-play-circle"></i> Initialize Courses</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC_lKWa4cM4cT337KkRw4sp7raQHl9aZWk",
  authDomain: "students-login-29409.firebaseapp.com",
  projectId: "students-login-29409",
  storageBucket: "students-login-29409.firebasestorage.app",
  messagingSenderId: "634331456872",
  appId: "1:634331456872:web:6dae360c5e28d8356562dd"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Predefined courses
const courses = [
  { id: "food_business_management", title: "Food Business Management Course", description:"Learn to manage your food business efficiently." },
  { id: "financial_management", title: "Financial Management for Food Processors", description:"Manage finances for food processing." },
  { id: "value_addition", title: "Food Value Addition Course for Farmers", description:"Increase the value of your farm products." },
  { id: "new_product_dev", title: "New Product Development and Management", description:"Develop and manage new food products." },
  { id: "management", title: "Management", description:"General management skills for food business." }
];

window.initCourses = async () => {
  for(const c of courses){
    const courseRef = doc(db,'courses',c.id);
    // Create course document
    await setDoc(courseRef,{
      title:c.title,
      description:c.description,
      published:true,
      createdAt:new Date()
    });
    // Create empty subcollections: modules and quizzes
    const modulesRef = collection(db,'courses',c.id,'modules');
    const quizzesRef = collection(db,'courses',c.id,'quizzes');

    // Optionally add an empty module as placeholder
    const placeholderModuleRef = doc(modulesRef,'module_1');
    await setDoc(placeholderModuleRef,{title:'Module 1',order:1});
    const lessonsRef = collection(modulesRef,'module_1','lessons'); // empty lessons

    console.log(`✅ Course ${c.title} created with placeholder module and empty lessons/quizzes.`);
  }
  alert("✅ All 5 courses initialized with subcollections successfully!");
};
</script>
</body>
</html>
