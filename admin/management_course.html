<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Firestore Admin Structure Init</title>
</head>
<body>

<h2>Initialize Firestore (Admin Structure)</h2>
<button onclick="initFirestore()">Initialize</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ðŸ”¹ Firebase config */
const firebaseConfig = {
  apiKey: "AIzaSyC_lKWa4cM4cT337KkRw4sp7raQHl9aZWk",
  authDomain: "students-login-29409.firebaseapp.com",
  projectId: "students-login-29409",
  storageBucket: "students-login-29409.appspot.com",
  messagingSenderId: "634331456872",
  appId: "1:634331456872:web:6dae360c5e28d8356562dd"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ðŸ”¹ ADMIN ID (CHANGE IF NEEDED) */
const ADMIN_ID = "admin_001";

/* ðŸ”¹ COURSES */
const courses = [
  { id:"food_business_management", title:"Food Business Management Course", description:"Course description here..." },
  { id:"financial_management", title:"Financial Management for Food Processors", description:"Course description here..." },
  { id:"value_addition", title:"Food Value Addition Course for Farmers", description:"Course description here..." },
  { id:"new_product_dev", title:"New Product Development and Management", description:"Course description here..." },
  { id:"management", title:"Management", description:"Course description here..." }
];

window.initFirestore = async () => {
  try {

    /* ðŸ”¹ CREATE ADMIN DOCUMENT */
    await setDoc(doc(db, "course", ADMIN_ID), {
      role: "admin",
      createdAt: new Date()
    });

    /* ðŸ”¹ CREATE FULL COURSE STRUCTURE */
    for (const c of courses) {

      await setDoc(
        doc(db, "course", ADMIN_ID, "courses", c.id),
        {
          title: c.title,
          description: c.description,
          published: true,
          createdAt: new Date()
        }
      );

      /* MODULES & LESSONS */
      for (let m = 1; m <= 2; m++) {
        const moduleId = `module_${m}`;

        await setDoc(
          doc(db, "course", ADMIN_ID, "courses", c.id, "modules", moduleId),
          { title: `Module ${m}`, order: m }
        );

        for (let l = 1; l <= 2; l++) {
          await setDoc(
            doc(
              db,
              "course",
              ADMIN_ID,
              "courses",
              c.id,
              "modules",
              moduleId,
              "lessons",
              `lesson_${l}`
            ),
            {
              title: `Lesson ${l}`,
              contentHTML: "",
              videoURL: "",
              images: [],
              ttsEnabled: false,
              createdAt: new Date()
            }
          );
        }
      }

      /* QUIZZES */
      for (let q = 1; q <= 2; q++) {
        await setDoc(
          doc(db, "course", ADMIN_ID, "courses", c.id, "quizzes", `quiz_${q}`),
          {
            question: `Question ${q}`,
            options: ["A","B","C","D"],
            correctIndex: 0,
            createdAt: new Date()
          }
        );
      }
    }

    /* ðŸ”¹ GLOBAL COLLECTIONS */
    await setDoc(doc(db, "payments", "placeholder"), { init: true });
    await setDoc(doc(db, "progress", "placeholder"), { init: true });
    await setDoc(doc(db, "certificates", "placeholder"), { init: true });

    alert("âœ… Firestore admin structure initialized successfully");

  } catch (err) {
    console.error(err);
    alert("âŒ Initialization failed â€“ check console");
  }
};
</script>

</body>
</html>
