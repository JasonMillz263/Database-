<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Manage Payments | Food Business Academy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#f4f6fb;
  --card:#ffffff;
  --blue:#2563eb;
  --green:#22c55e;
  --pending:#f59e0b;
  --text:#1f2937;
  --muted:#6b7280;
}

*{box-sizing:border-box;font-family:'Poppins',sans-serif}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
}

header{
  background:#fff;
  padding:20px 30px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 6px 20px rgba(0,0,0,.06);
}

header h1{
  font-size:22px;
  margin:0;
}

header button{
  background:var(--blue);
  color:#fff;
  border:none;
  padding:10px 16px;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
}

main{
  padding:30px;
  max-width:1200px;
  margin:auto;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:24px;
}

.card{
  background:var(--card);
  border-radius:20px;
  padding:22px;
  box-shadow:0 12px 30px rgba(0,0,0,.08);
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  position:relative;
}

.status{
  position:absolute;
  top:18px;
  right:18px;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  color:#fff;
}

.pending{background:var(--pending)}
.paid{background:var(--green)}

.card h3{
  margin:0 0 6px;
  font-size:18px;
}

.info{
  font-size:14px;
  color:var(--muted);
  margin-bottom:6px;
}

.course{
  margin:14px 0;
  font-weight:600;
}

.actions{
  margin-top:16px;
}

.actions button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:14px;
  font-weight:600;
  cursor:pointer;
}

.approve{
  background:linear-gradient(135deg,var(--green),#16a34a);
  color:#fff;
}

.disabled{
  background:#e5e7eb;
  color:#9ca3af;
  cursor:not-allowed;
}
</style>
</head>

<body>

<header>
  <h1>üí≥ Manage Payments</h1>
  <button onclick="location.href='#'">üè† Admin Dashboard</button>
</header>

<main>
  <div class="grid" id="paymentsGrid"></div>
</main>

<script>
/*
  DATA SOURCE
  - student data stored from registration
  - course status stored in courseStatus
*/

const paymentsGrid = document.getElementById("paymentsGrid");

/* Example student data source (already saved during registration/payment) */
const students = JSON.parse(localStorage.getItem("payments")) || [];

/* Course status map */
const courseStatus = JSON.parse(localStorage.getItem("courseStatus")) || {};

if(students.length === 0){
  paymentsGrid.innerHTML = "<p>No payments found.</p>";
}

students.forEach((p, index) => {
  const studentCourses = courseStatus[p.email] || {};
  const status = studentCourses[p.course] || "pending";

  paymentsGrid.innerHTML += `
    <div class="card">
      <div class="status ${status === 'paid' ? 'paid' : 'pending'}">
        ${status === 'paid' ? 'Paid' : 'Pending'}
      </div>

      <div>
        <h3>${p.name}</h3>
        <div class="info">üìß ${p.email}</div>
        <div class="info">üìû ${p.phone || 'N/A'}</div>

        <div class="course">üìò ${p.course}</div>
      </div>

      <div class="actions">
        ${
          status === "pending"
          ? `<button class="approve" onclick="approvePayment('${p.email}','${p.course}')">Approve Payment</button>`
          : `<button class="disabled" disabled>Payment Approved</button>`
        }
      </div>
    </div>
  `;
});

function approvePayment(email, course){
  const statusData = JSON.parse(localStorage.getItem("courseStatus")) || {};
  if(!statusData[email]) statusData[email] = {};

  statusData[email][course] = "paid";

  localStorage.setItem("courseStatus", JSON.stringify(statusData));

  alert("Payment approved successfully ‚úÖ");
  location.reload();
}
</script>

</body>
</html>
