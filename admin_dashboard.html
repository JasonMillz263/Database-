<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- YOUR STYLES REMAIN EXACTLY THE SAME -->
</head>

<body>

<!-- YOUR HTML CONTENT REMAINS UNCHANGED -->

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC_lKWa4cM4cT337KkRw4sp7raQHl9aZWk",
  authDomain: "students-login-29409.firebaseapp.com",
  projectId: "students-login-29409"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

/* ðŸ” ADMIN PROTECTION */
auth.onAuthStateChanged(async user => {
  if (!user) {
    location.href = "index.html";
    return;
  }

  const token = await user.getIdTokenResult();

  // ðŸš« BLOCK STUDENTS
  if (!token.claims.admin) {
    alert("Access denied");
    location.href = "student.html";
    return;
  }

  // âœ… ADMIN ALLOWED
  document.getElementById("adminId").innerText = user.uid.slice(0, 8);

  // Stats
  const students = await db.collection("students").get();
  document.getElementById("totalStudents").innerText = students.size;

  const courses = await db.collection("courses").get();
  document.getElementById("totalCourses").innerText = courses.size;

  const certs = await db.collection("certificates").get();
  document.getElementById("totalCertificates").innerText = certs.size;
});

/* LOGOUT */
function logout() {
  auth.signOut().then(() => location.href = "index.html");
}
</script>

</body>
</html>
